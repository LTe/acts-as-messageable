matrix:
  allow_failures:
    - rvm: ruby-head
  include:
    - rvm: 2.3.8
      gemfile: gemfiles/rails_3.2.gemfile
    - rvm: 2.3.8
      gemfile: gemfiles/rails_4.2.gemfile
    - rvm: 2.7
      gemfile: gemfiles/rails_5.2.gemfile
    - rvm: 2.7
      gemfile: gemfiles/rails_6.0.gemfile
    - rvm: 2.7
      gemfile: gemfiles/rails_5.2.gemfile
    - rvm: 2.7
      env: RUN_GENERATORS=true
      gemfile: gemfiles/rails_6.0.gemfile
    - rvm: 2.7
      gemfile: gemfiles/rails_master.gemfile
    - rvm: ruby-head
      gemfile: gemfiles/rails_master.gemfile
    - rvm: 2.7
      stage: "Static analysis"
      gemfile: gemfiles/rails_6.0.gemfile
      name: "Rubocop"
      script: rake rubocop
before_install:
  - gem update --system
  - gem install bundler
install: bundle install --jobs=3 --retry=3
